<ion-content [ngClass]="{'default': !showFeedback(), 'success': showFeedback() && slideInfo[currentSlide].stage == Stage.CORRECT, 'failure': showFeedback() && slideInfo[currentSlide].stage == Stage.INCORRECT}">

  <ion-progress-bar style="margin-top: 0px" value={{progressPercent}}></ion-progress-bar>

  <div *ngIf="slideInfo[currentSlide].stage == Stage.START" (click)="startMemorizeTimer()" class="overlay" button>
    <div class="overlay-content">
      Click anywhere to reveal
    </div>
  </div>

  <ion-slides #slideElement (ionSlideWillChange)="changeSlide()">

    <ion-slide *ngFor="let slide of slideInfo; let slideIndex = index" style="text-align: center; height: 100%; width: 100%; display: block">
  
      <!--Memorizing the face-->
      <div *ngIf="firstStage(slideIndex)">
        <h3 *ngIf="slideInfo[slideIndex].stage == Stage.START">Memorize the face: {{memorizeTime}}</h3>
        <h3 *ngIf="slideInfo[slideIndex].stage == Stage.MEMORIZE">Memorize the face: <span class="time-left">{{timeRemaining}}</span></h3>
        <h3 *ngIf="slideInfo[slideIndex].stage == Stage.MASK">Hold the face in your mind...</h3>
        <ion-card style="height: 310px">
          <img *ngIf="slideInfo[slideIndex].stage != Stage.START" style="height: 270px; margin: 20px auto;" [src]="slideInfo[slideIndex].stage == Stage.MEMORIZE ? slideInfo[slideIndex].correctFace : mask" [ngStyle]="{'width': slideInfo[slideIndex].stage == Stage.MASK ? '85%' : 'auto'}"/>
        </ion-card>
      </div>

      <!--Choosing the face and feedback-->
      <div *ngIf="!firstStage(slideIndex)" style="text-align: center">

        <h5 *ngIf="slideInfo[slideIndex].stage == Stage.SELECT">Who did you see?</h5>
        <h5 *ngIf="slideInfo[slideIndex].stage == Stage.CORRECT">Correct!</h5>
        <h5 *ngIf="slideInfo[slideIndex].stage == Stage.INCORRECT">Incorrect!</h5>

        <ion-grid>

          <ion-row>

            <ion-col>
              <ion-card (click)="selectFace(slideInfo[slideIndex].faces[0])" [button]="!showFeedback()" class="grid-card" [ngClass]="{'selected-card': showFeedback() && slideInfo[slideIndex].faces[0] != slideInfo[slideIndex].correctFace && slideInfo[slideIndex].faces[0] == slideInfo[slideIndex].selectedFace, 'disabled-card': showFeedback() && slideInfo[slideIndex].faces[0] != slideInfo[slideIndex].correctFace}">
                <img [src]="slideInfo[slideIndex].faces[0]"/>
              </ion-card>
            </ion-col>

            <ion-col>
              <ion-card (click)="selectFace(slideInfo[slideIndex].faces[1])" [button]="!showFeedback()" class="grid-card" [ngClass]="{'selected-card': showFeedback() && slideInfo[slideIndex].faces[1] != slideInfo[slideIndex].correctFace && slideInfo[slideIndex].faces[1] == slideInfo[slideIndex].selectedFace, 'disabled-card': showFeedback() && slideInfo[slideIndex].faces[1] != slideInfo[slideIndex].correctFace}">
                <img [src]="slideInfo[slideIndex].faces[1]"/>
              </ion-card>
            </ion-col>

          </ion-row>
          <ion-row>

            <ion-col>
              <ion-card (click)="selectFace(slideInfo[slideIndex].faces[2])" [button]="!showFeedback()" class="grid-card" [ngClass]="{'selected-card': showFeedback() && slideInfo[slideIndex].faces[2] != slideInfo[slideIndex].correctFace && slideInfo[slideIndex].faces[2] == slideInfo[slideIndex].selectedFace, 'disabled-card': showFeedback() && slideInfo[slideIndex].faces[2] != slideInfo[slideIndex].correctFace}">
                <img [src]="slideInfo[slideIndex].faces[2]"/>
              </ion-card>
            </ion-col>

            <ion-col>
              <ion-card (click)="selectFace(slideInfo[slideIndex].faces[3])" [button]="!showFeedback()" class="grid-card" [ngClass]="{'selected-card': showFeedback() && slideInfo[slideIndex].faces[3] != slideInfo[slideIndex].correctFace && slideInfo[slideIndex].faces[3] == slideInfo[slideIndex].selectedFace, 'disabled-card': showFeedback() && slideInfo[slideIndex].faces[3] != slideInfo[slideIndex].correctFace}">
                <img [src]="slideInfo[slideIndex].faces[3]"/>
              </ion-card>
            </ion-col>

          </ion-row>

        </ion-grid>

      </div>

      <ion-item *ngIf="showFeedback()" class="footer" lines="none">
        <ion-label>Swipe to Continue</ion-label>
        <ion-icon slot="end" color="dark" name="arrow-back" style="margin-top: 10px"></ion-icon>    
      </ion-item>

    </ion-slide>

    <!--Score page-->
    <ion-slide>
      <app-score-page [score]="score" (finished)="finished.emit([score, $event])"></app-score-page>
    </ion-slide>

  </ion-slides>

</ion-content>
